<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
  <head>
    <title>
Bugzilla::API::Server</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" title="style" type="text/css" href="../.././../../../../style.css" media="all" >

</head>
  <body id="pod">
<p class="backlinktop"><b><a name="___top" href="../../index.html" accesskey="1" title="All Documents">&lt;&lt;</a></b></p>
<h1>Bugzilla::API::Server</h1>
<div class='indexgroup'>
<ul   class='indexList indexList1'>
  <li class='indexItem indexItem1'><a href='#NAME'>NAME</a>
  <li class='indexItem indexItem1'><a href='#DESCRIPTION'>DESCRIPTION</a>
  <li class='indexItem indexItem1'><a href='#USAGE'>USAGE</a>
  <li class='indexItem indexItem1'><a href='#BROWSING'>BROWSING</a>
  <li class='indexItem indexItem1'><a href='#DATA_FORMAT'>DATA FORMAT</a>
  <li class='indexItem indexItem1'><a href='#AUTHENTICATION'>AUTHENTICATION</a>
  <li class='indexItem indexItem1'><a href='#ERRORS'>ERRORS</a>
  <li class='indexItem indexItem1'><a href='#CONSTANTS'>CONSTANTS</a>
  <li class='indexItem indexItem1'><a href='#METHODS'>METHODS</a>
  <li class='indexItem indexItem1'><a href='#Methods_in_need_of_POD'>Methods in need of POD</a>
</ul>
</div>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="NAME"
>NAME</a></h1>

<p>Bugzilla::API::Server - The Web Service API interface to Bugzilla</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DESCRIPTION"
>DESCRIPTION</a></h1>

<p>This is the standard API for external programs that want to interact with Bugzilla.
It provides various resources in various modules.</p>

<p>You interact with this API using <a href="../../Bugzilla/API/Server.html" class="podlinkpod"
>REST</a>.</p>

<p>Full client documentation for the Bugzilla API can be found at <a href="https://bugzilla.readthedocs.org/en/latest/api/index.html" class="podlinkurl"
>https://bugzilla.readthedocs.org/en/latest/api/index.html</a>.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="USAGE"
>USAGE</a></h1>

<p>Methodl are grouped into &#34;namespaces&#34;,
like <code  class="code">core</code> for native Bugzilla API methods.
Extensions reside in their own <i>namespaces</i> such as <code  class="code">Example</code>.
So,
for example:</p>

<p>GET /example/1.0/bug1</p>

<p>calls</p>

<p>GET /bug/1</p>

<p>in the <code  class="code">Example</code> namespace.</p>

<p>The endpoint for the API interface is the <code  class="code">rest.cgi</code> script in your Bugzilla installation.
For example,
if your Bugzilla is at <code  class="code">bugzilla.yourdomain.com</code>,
to access the API and load a bug,
you would use <code  class="code">http://bugzilla.yourdomain.com/rest.cgi/core/1.0/bug/35</code>.</p>

<p>If using Apache and mod_rewrite is installed and enabled,
you can simplify the endpoint by changing /rest.cgi/ to something like /api/ or something similar.
So the same example from above would be: <code  class="code">http://bugzilla.yourdomain.com/api/core/1.0/bug/35</code> which is simpler to remember.</p>

<p>Add this to your .htaccess file:</p>

<pre  class="code">  &#60;IfModule mod_rewrite.c&#62;
    RewriteEngine On
    RewriteRule ^rest/(.*)$ rest.cgi/$1 [NE]
  &#60;/IfModule&#62;</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="BROWSING"
>BROWSING</a></h1>

<p>If the Accept: header of a request is set to text/html (as it is by an ordinary web browser) then the API will return the JSON data as a HTML page which the browser can display. In other words, you can play with the API using just your browser and see results in a human-readable form. This is a good way to try out the various GET calls, even if you can&#39;t use it for POST or PUT.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="DATA_FORMAT"
>DATA FORMAT</a></h1>

<p>The API only supports JSON input, and either JSON and JSONP output. So objects sent and received must be in JSON format.</p>

<p>On every request, you must set both the &#34;Accept&#34; and &#34;Content-Type&#34; HTTP headers to the MIME type of the data format you are using to communicate with the API. Content-Type tells the API how to interpret your request, and Accept tells it how you want your data back. &#34;Content-Type&#34; must be &#34;application/json&#34;. &#34;Accept&#34; can be either that, or &#34;application/javascript&#34; for JSONP - add a &#34;callback&#34; parameter to name your callback.</p>

<p>Parameters may also be passed in as part of the query string for non-GET requests and will override any matching parameters in the request body.</p>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="AUTHENTICATION"
>AUTHENTICATION</a></h1>

<p>Along with viewing data as an anonymous user, you may also see private information if you have a Bugzilla account by providing your login credentials.</p>

<dl>
<dt><a name="Login_name_and_password"
>Login name and password</a></dt>

<dd>
<p>Pass in as query parameters of any request:</p>

<p>login=fred@example.com&#38;password=ilovecheese</p>

<p>Remember to URL encode any special characters, which are often seen in passwords and to also enable SSL support.</p>

<dt><a name="Login_token"
>Login token</a></dt>

<dd>
<p>By calling GET /login?login=fred@example.com&#38;password=ilovecheese, you get back a <code  class="code">token</code> value which can then be passed to each subsequent call as authentication. This is useful for third party clients that cannot use cookies and do not want to store a user&#39;s login and password in the client. You can also pass in &#34;token&#34; as a convenience.</p>

<dt><a name="API_Key"
>API Key</a></dt>

<dd>
<p>You can also authenticate by passing an <code  class="code">api_key</code> value as part of the query parameters which is setup using the <i>API Keys</i> tab in <code  class="code">userprefs.cgi</code>.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="ERRORS"
>ERRORS</a></h1>

<p>When an API error occurs, a data structure is returned with the key <code  class="code">error</code> set to <code  class="code">true</code>.</p>

<p>The error contents look similar to:</p>

<pre  class="code"> { &#34;error&#34;: true, &#34;message&#34;: &#34;Some message here&#34;, &#34;code&#34;: 123 }</pre>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="CONSTANTS"
>CONSTANTS</a></h1>

<dl>
<dt><a name="DEFAULT_API_VERSION"
>DEFAULT_API_VERSION</a></dt>

<dd>
<p>The default API version that is used by <code  class="code">server</code>. Current default is <a href="../../1.0.html" class="podlinkpod"
>1.0</a> which is the first version of the API implemented in this way..</p>

<dt><a name="DEFAULT_API_NAMESPACE"
>DEFAULT_API_NAMESPACE</a></dt>

<dd>
<p>The default API namespace that is used if <code  class="code">server</code> is called before <code  class="code">init_serber</code>. Current default is <a href="../../core.html" class="podlinkpod"
>core</a> which is the native API methods (non-extension).</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="METHODS"
>METHODS</a></h1>

<p>The <a href="../../Bugzilla/API/Server.html" class="podlinkpod"
>Bugzilla::API::Server</a> has the following methods used by various code in Bugzilla.</p>

<dl>
<dt><a name="server"
>server</a></dt>

<dd>
<p>Returns a <a href="../../Bugzilla/API/Server.html" class="podlinkpod"
>Bugzilla::API::Server</a> object after looking at the cgi path to determine which version of the API is being requested and which namespace to load methods from. A new server instance of the proper version is returned.</p>

<dt><a name="constants"
>constants</a></dt>

<dd>
<p>A method return a hash containing the constants from the Constants.pm module in the API version directory. The calling code will not need to know which version of the API is being used to access the constant values.</p>

<dt><a name="json"
>json</a></dt>

<dd>
<p>Returns a <a href="../../JSON.html" class="podlinkpod"
>JSON</a> encode/decoder object.</p>

<dt><a name="load_error"
>load_error</a></dt>

<dd>
<p>Method that stores error data if a API module fails to load and ThrowUserError or ThrowCodeError needs to send a proper error to the client.</p>

<dt><a name="cgi"
>cgi</a></dt>

<dd>
<p>Returns a <a href="../../Bugzilla/CGI.html" class="podlinkpod"
>Bugzilla::CGI</a> object.</p>

<dt><a name="request"
>request</a></dt>

<dd>
<p>Returns a <a href="../../HTTP/Request.html" class="podlinkpod"
>HTTP::Request</a> object.</p>

<dt><a name="response_header"
>response_header</a></dt>

<dd>
<p>Returns a <a href="../../HTTP/Response.html" class="podlinkpod"
>HTTP::Response</a> object with the appropriate content-type set. Requires that a status code and content data to be passed in.</p>

<dt><a name="handle"
>handle</a></dt>

<dd>
<p>Handles the current request by finding the correct resource, setting the parameters, authentication, executing the resource, and forming an appropriate response.</p>

<dt><a name="response"
>response</a></dt>

<dd>
<p>Encodes the return data in the requested content-type and also does some other changes such as conversion to JSONP and setting status_code. Also sets the eTag header values based on the result content.</p>

<dt><a name="print_response"
>print_response</a></dt>

<dd>
<p>Prints the final response headers and content to STDOUT.</p>

<dt><a name="handle_login"
>handle_login</a></dt>

<dd>
<p>Authenticates the user and performs additional checks.</p>

<dt><a name="return_error"
>return_error</a></dt>

<dd>
<p>If an error occurs, this method will return a data structure describing the error with a code and message.</p>

<dt><a name="callback"
>callback</a></dt>

<dd>
<p>When calling the API over GET, you can use the &#34;JSONP&#34; method of doing cross-domain requests, if you want to access the API directly on a web page from another site. JSONP is described at <a href="http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/" class="podlinkurl"
>http://bob.pythonmac.org/archives/2005/12/05/remote-json-jsonp/</a>.</p>

<p>To use JSONP with Bugzilla&#39;s API, simply specify a <code  class="code">callback</code> parameter when using it via GET as described above. For example, here&#39;s some HTML you could use to get the time on a remote Bugzilla website, using JSONP:</p>

<pre  class="code"> &#60;script type=&#34;text/javascript&#34; src=&#34;http://bugzilla.example.com/time?callback=foo&#34;&#62;</pre>

<p>That would call the API path for <code  class="code">time</code> and pass its value to a function called <code  class="code">foo</code> as the only argument. All the other URL parameters (such as for passing in arguments to methods) that can be passed during GET requests are also available, of course. The above is just the simplest possible example.</p>

<p>The values returned when using JSONP are identical to the values returned when not using JSONP, so you will also get error messages if there is an error.</p>

<p>The <code  class="code">callback</code> URL parameter may only contain letters, numbers, periods, and the underscore (<code  class="code">_</code>) character. Including any other characters will cause Bugzilla to throw an error. (This error will be a normal API response, not JSONP.)</p>

<dt><a name="etag"
>etag</a></dt>

<dd>
<p>Using the data structure passed to the subroutine, we convert the data to a string and then md5 hash the string to creates a value for the eTag header. This allows a user to include the value in seubsequent requests and only return the full data if it has changed.</p>

<dt><a name="api_ext"
>api_ext</a></dt>

<dd>
<p>A boolean value signifying if the current request is for an API method is exported by an extension or is part of the core methods.</p>

<dt><a name="api_ext_version"
>api_ext_version</a></dt>

<dd>
<p>If the current request is for an extension API method, this is the version of the extension API that should be used.</p>

<dt><a name="api_namespace"
>api_namespace</a></dt>

<dd>
<p>The current namespace of the API method being requested as determined by the cgi path. If a namespace is not provided, we default to <a href="../../core.html" class="podlinkpod"
>core</a>.</p>

<dt><a name="api_options"
>api_options</a></dt>

<dd>
<p>Once a resource has been matched to the current request, this the available options to the client such as GET, PUT, etc.</p>

<dt><a name="api_params"
>api_params</a></dt>

<dd>
<p>Once a resource has been matched, this is the params that were pulled from the regex used to match the resource. This could be a resource id or name such as a bug id, etc.</p>

<dt><a name="api_path"
>api_path</a></dt>

<dd>
<p>The final cgi path after namespace and version have been removed. This is the path used to locate a matching resource from the controller modules.</p>

<dt><a name="api_version"
>api_version</a></dt>

<dd>
<p>The current version of the <a href="../../core.html" class="podlinkpod"
>core</a> API that is being used for processing the request. Note that this version may be different from <code  class="code">api_ext_version</code> if the client requested a method in an extension&#39;s namespace.</p>

<dt><a name="content_type"
>content_type</a></dt>

<dd>
<p>The content-type of the data that will be returned. The current default is <a href="../../application.html#json" class="podlinkpod"
>&#34;json&#34; in application</a>. If a caller is msking a request using a browser, it will most likely be <a href="../../text.html#html" class="podlinkpod"
>&#34;html&#34; in text</a>.</p>

<dt><a name="controller"
>controller</a></dt>

<dd>
<p>Once a resource has been matched, this is the controller module that contains the method that will be executed.</p>

<dt><a name="method_name"
>method_name</a></dt>

<dd>
<p>The method in the controller module that will be executed to handle the request.</p>

<dt><a name="success_code"
>success_code</a></dt>

<dd>
<p>The success code to be used when creating the <a href="../../response.html" class="podlinkpod"
>response</a> object to be returned. It can be different depending on if the request was successful, a resource was created, or an error occurred.</p>
</dd>
</dl>

<h1><a class='u' href='#___top' title='click to go to top of document'
name="Methods_in_need_of_POD"
><b>Methods in need of POD</b></a></h1>

<dl>
<dt><a name="ThrowCodeError"
>ThrowCodeError</a></dt>

<dd>
<dt><a name="ThrowUserError"
>ThrowUserError</a></dt>
</dl>
<p class="backlinkbottom"><b><a name="___bottom" href="../../index.html" title="All Documents">&lt;&lt;</a></b></p>

<!-- end doc -->

</body></html>
