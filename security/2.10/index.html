<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang="en">
<head>
  <title>2.10 Security Advisory :: Bugzilla :: bugzilla.org</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="keywords" content="bugzilla bug track tracking enterprise solution">
  <link rel="icon" href="/img/bugzilla_icon.png" type="image/png">
  <link rel="stylesheet" type="text/css" href="/css/print.css" media="print">
  <link rel="stylesheet" type="text/css" href="/css/base/content.css" media="all">
  <link rel="stylesheet" type="text/css" href="/css/cavendish/content.css" title="Cavendish" media="all">
  <link rel="stylesheet" type="text/css" href="/css/base/template.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/bugzilla.css" media="screen">
  <link rel="stylesheet" type="text/css" href="/css/cavendish/home.css" title="Cavendish" media="screen">
</head>
<body id="www-bugzilla-org" class="homepage">
  <div id="container">
    <p class="skipLink"><a href="#mainContent" accesskey="2">Skip to main content</a></p>
    <div id="header">
      <h1><a href="/" title="Return to Bugzilla home page" accesskey="1">Bugzilla</a></h1>
      <div id="tools">
        <ul id="mainNav">
          <li><a href="/contribute/" title="How to Help"
            >Contribute!</a></li>
          <li><a href="/features/" title="Bugzilla features">Features</a></li>
          <li><a href="/download/" title="Get Bugzilla for free">Download</a></li>
          <li><a href="/support/" title="Where to get more help">Support</a></li>
          <li><a href="/docs/" title="Bugzilla documenation">Docs</a></li>
          <li><a href="/news/" title="Read about what is happening with Bugzilla">News</a></li>
          <li><a href="/about/" title="Getting the most out of your online experience">About</a></li>
        </ul>
        <!-- closes #textSize-->
        <form id="search" method="get" action="https://www.google.com/cse">
          <div id="sf">
            <label for="q" title="Search bugzilla.org">search bugzilla.org: </label>
            <input type="hidden" name="cx" value="008043952663535741821:9whwb87ip5a">
            <input type="text" id="q" name="q" accesskey="s" size="30">
            <input type="submit" id="submit" value="go">
          </div>
        </form>
      </div>
     <!-- closes #tools-->
    </div>
    <!-- closes #header-->
    <hr class="hide">
    <div id="mBody">

        <hr class="hide"><div id="side">
<ul id="nav">
<li>
	<a href="/about/" title="Find out more about Bugzilla."><strong>About</strong></a>
	<ul>
		<li><a href="/installation-list/" title="Hundreds of companies and organizations trust Bugzilla.">Who Uses Bugzilla?</a></li>
		<li><a href="/status/roadmap.html" title="Learn about Bugzilla's future.">Roadmap</a></li>
		<li><a href="/developers/profiles.html" title="Meet the Bugzilla team.">Meet the Team</a></li>
		<li><a href="/releases/" title="Information on current and previous releases.">Release Information</a></li>
	</ul>
</li>
<li>
	<a href="/news/" title="Get the low down on what's happening with the project."><strong>News</strong></a>
	<ul>
		<li><a href="http://planet.bugzilla.org" title="View the status of the Bugzilla project.">Planet Bugzilla</a></li>
		<li><a href="/security/" title="Important updates regarding Bugzilla security.">Security Advisories</a></li>
        <li><a href="/status/changes.html" title="Detailed list of all the changes between each Bugzilla version">Change Logs</a></li>
	</ul>
</li>
<li>
        <a href="/download/" title="Download Bugzilla"><strong>Download</strong></a>
        <ul>
                <li><a href="https://wiki.mozilla.org/Bugzilla:Addons" title="Third-party Bugzilla extensions">Extensions</a></li>
                <li><a href="/requirements/">Requirements</a></li>
        </ul>
</li>
<li>
	<a href="/support/" title="Find out where to get more information and help."><strong>Support</strong></a>
	<ul>
                <li><a href="/support/" title="Find out where to get more information and help.">Free Support</a></li>
                <li><a href="/support/consulting.html" title="Paid support options">Paid Support</a></li>
		<li><a href="/docs/" title="Read the Bugzilla manual and other important documents.">Documentation</a></li>
		<li><a href="https://wiki.mozilla.org/Bugzilla" title="Collaboratively updated information about Bugzilla.">Wiki</a></li>
		<li><a href="/developers/reporting_bugs.html" title="Let us know if there is an error in Bugzilla.">Report a Bug</a></li>
	</ul>
</li>
<li>
	<a href="/developers/" title="Developer resources">Developer Resources</a>
</li>
  <li>
    <a href="/contribute/" title="Ways you can help Bugzilla"
    >How To Help Out</a>
  </li>
</ul>

<div>
<p><a href="https://twitter.com/bugzilla">Follow @bugzilla on Twitter</a></p>
<p><a href="https://www.facebook.com/pages/Bugzilla/1427568330846442">Like Bugzilla on Facebook</a></p>
<p><a href="https://plus.google.com/u/0/104215203522965843895?prsrc=3">Follow Bugzilla on Google+</a></p>
</div>
</div>
<!-- closes #side -->      <div id="mainContent">
        <h1>2.10 Security Advistory</h1>
<PRE>
Bugzilla Security Advisory
May 9th 2000
Author: Chris Yeh (cyeh@bluemartini.com)


Users of Bugzilla are recommended to apply the following patch or upgrade to version
2.10 of Bugzilla.


Index: CGI.pl
===================================================================
RCS file: /cvsroot/mozilla/webtools/bugzilla/CGI.pl,v
retrieving revision 1.65
diff -u -r1.65 CGI.pl
--- CGI.pl      2000/04/27 23:12:44     1.65
+++ CGI.pl      2000/05/05 04:56:24
@@ -560,6 +560,11 @@
             }
         }
     }
+    # if 'who' is passed in, verify that it's a good value
+    if ($::FORM{'who'}) {
+        my $whoid = DBname_to_id($::FORM{'who'});
+        delete $::FORM{'who'} unless $whoid;
+    }
     if (!$loginok) {
         delete $::COOKIE{"Bugzilla_login"};
     }

It is also recommended that you closely examine permissions on your Bugzilla
installation.

Make sure you are not running mysqld as root.

Included is one person's examination of their local bugzilla installation, 
and how they secured it.

----------------------------------------------------------------------------------

I closed-up some of the all-writeable files and directories. The code itself had
to be modified to keep it from making directories and files world-writeable again...

Once this was done, I felt confident that this install of bugzilla was running
securely.(We don't run ftp, and mysql doesn't run as root). 

The setup we have is that apache runs as user 'nobody'. Directories being written into
via CGI are therefore owner.group==nobody.nobody and only read/writable by user nobody,
not world-writeable as before ... The *.cgi/*.pl/etc scripts (source) are owned by
root.root and we can prevent CGI execution and HTTPD reading of the scripts by doing
chmod go-rwx.... Finally, we prevent reading of the writeable directories by HTTP.
(The security of this could further be improved by running bugzilla as user 'bugzilla'
with same privs as 'nobody' but at least a different user than the webserver).

I did the following to secure our install:

(1) cd /home/httpd/bugzilla ensure all files owned root.root (other than ones in
'shadow' and 'data').

(2) chmod go-rwx backdoor.cgi ; chmod go-rwx *.sh ; chmod go-rwx printenv.cgi ;
chmod go-rwx 0CGI.pl ; chmod go-rwx *~* ; chown -R nobody.nobody data ;
chmod -R go-rwx data ; chown -R nobody.nobody shadow ; chmod -R go-rwx shadow

(3) in emacs, in *.pl and *.cgi and processmail in bugzilla dir
(etags *.cgi *.pl processmail) ... do:

(tags-query-replace "umask 0" "umask 077" nil)
(tags-query-replace "umask(0)" "umask(077)" nil)
(tags-query-replace "0777" "0700" nil)
(tags-query-replace "0666" "0600" nil)

(4) reenable bugzilla with /home/httpd/bug-track.conf set to:
--------------------
AddHandler cgi-script .cgi

#
# setup ExecCGI'able directory alias from which we run
# "bugzilla" under URL "bugs"
#
Alias /bugs/ "/home/httpd/bugzilla/"

&lt;Directory "/home/httpd/bugzilla"&gt;
Options Indexes ExecCGI
AllowOverride None
Order allow,deny
Allow from all
&lt;/Directory&gt;
--------------------

(5) add to /home/httpd/bug-track.conf (prevent cgi from being
written into data or shadow directories, and prevent contents from
being read):
--------------------
&lt;Directory "/home/httpd/bugzilla/data"&gt;
Options None
AllowOverride None
Deny from all
&lt;/Directory&gt;

&lt;Directory "/home/httpd/bugzilla/shadow"&gt;
Options None
AllowOverride None
Deny from all
&lt;/Directory&gt;
--------------------

(6) I noticed that my
non-superuser-$PATH had wound up in apache's GGI
environment... that $PATH included "." so that could have been a
security-exploit-in-waiting right there... so remember, when
restarting apache on servers, do (in tcsh anyways):
unsetenv *
prior to doing
apachectl stop
&lt;wait&gt;
apachectl start

</PRE>
        
      </div>
    </div></div>
  <!-- closes #container -->
  <div id="footer">
    <ul>
      <li><a href="https://www.mozilla.org/contact/">Contact Us</a></li>
      <li><a href="https://donate.mozilla.org/page/contribute/bugzilla">Donate</a></li>
    </ul>
<!-- Creative Commons License -->
<p class="copyright">This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/2.0/">Creative Commons License</a>.</p>

<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->
<!-- /Creative Commons License -->

    <p class="copyright">Portions of this work are &copy;
      1998-2016
      by individual bugzilla.org contributors.</p>
    <p>
      <span>Last modified October 27, 2016</span>
      <span><a href="https://github.com/bugzilla/bugzilla.org/commits/master">Site History</a></span>
    </p>
  </div>
</body>
</html>